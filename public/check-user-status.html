<!DOCTYPE html>
<html>
<head>
    <title>Test User Creation - Check isActive</title>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
        import { getFirestore, collection, getDocs } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDQdwrJPIl0rIMh5b9JaKOD9Zz3bNJd1R4",
            authDomain: "invoice-management-d6ea7.firebaseapp.com",
            projectId: "invoice-management-d6ea7",
            storageBucket: "invoice-management-d6ea7.appspot.com",
            messagingSenderId: "286610896823",
            appId: "1:286610896823:web:2ee1c5e7c124c1b7a8d6f7"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function checkUserActivation() {
            try {
                console.log('üîç Checking user activation status...');
                document.getElementById('output').innerHTML += 'üîç Checking user activation status...<br>';
                
                const usersSnapshot = await getDocs(collection(db, 'users'));
                
                if (usersSnapshot.empty) {
                    document.getElementById('output').innerHTML += '‚ùå No users found<br>';
                    return;
                }
                
                document.getElementById('output').innerHTML += `üìä Found ${usersSnapshot.size} users:<br><br>`;
                
                usersSnapshot.forEach(doc => {
                    const userData = doc.data();
                    const isActiveStatus = userData.isActive;
                    const statusEmoji = isActiveStatus ? '‚úÖ' : '‚ùå';
                    
                    document.getElementById('output').innerHTML += 
                        `${statusEmoji} <strong>${userData.email}</strong><br>` +
                        `&nbsp;&nbsp;Role: ${userData.role}<br>` +
                        `&nbsp;&nbsp;isActive: ${isActiveStatus}<br>` +
                        `&nbsp;&nbsp;status: ${userData.status}<br>` +
                        `&nbsp;&nbsp;Created: ${userData.createdAt}<br>` +
                        `&nbsp;&nbsp;Has permissions: ${userData.permissions ? 'Yes (' + userData.permissions.length + ')' : 'No'}<br><br>`;
                });
                
            } catch (error) {
                console.error('‚ùå Error:', error);
                document.getElementById('output').innerHTML += `‚ùå Error: ${error.message}<br>`;
            }
        }

        window.addEventListener('load', () => {
            document.getElementById('checkButton').addEventListener('click', checkUserActivation);
        });
    </script>
</head>
<body>
    <h1>Check User Activation Status</h1>
    <p>This will check if users created by Master Admin have isActive: true in Firestore.</p>
    
    <button id="checkButton">Check User Status</button>
    
    <h2>Results:</h2>
    <div id="output" style="background: #f5f5f5; padding: 10px; min-height: 100px; font-family: monospace; white-space: pre-wrap;"></div>
</body>
</html>